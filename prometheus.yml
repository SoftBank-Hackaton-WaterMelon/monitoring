global:
  # 팀 요청 반영: 수집 주기 60초
  scrape_interval: 60s

scrape_configs:
  # Prometheus 자기 자신
  - job_name: prometheus
    static_configs:
      - targets: ['prometheus:9090']

  # cAdvisor(컨테이너 리소스 메트릭)
  - job_name: cadvisor
    static_configs:
      - targets: ['cadvisor:8080']

  # demo-backend 앱 메트릭 (/metrics)
  # 같은 compose 네트워크가 아니라도, 호스트에서 띄운 앱은 host.docker.internal 로 접근 가능(맥/윈도우).
  # Linux에서는 아래 주석 참고.
  - job_name: demo-backend
    metrics_path: /metrics
    static_configs:
      - targets:
          - 'host.docker.internal:8080'  # ← 앱이 로컬 호스트 8080일 때
    relabel_configs:
      - target_label: service
        replacement: demo-backend

# (Linux 팁)
# - Linux는 'host.docker.internal' 이 기본적으로 안 먹을 수 있습니다.
#   1) prometheus 서비스에 extra_hosts 추가:
#      extra_hosts:
#        - "host.docker.internal:172.17.0.1"
#   2) 혹은 demo-backend와 prometheus를 같은 브리지 네트워크에 올리고
#      targets: ['demo-backend:8080'] 로 변경